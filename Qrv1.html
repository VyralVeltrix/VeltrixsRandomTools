<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Auto-Sizing QR Generator</title>
    
    <!-- 1. Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configure Tailwind for Dark Mode and Custom Colors -->
    <script>
        tailwind.config = {
            darkMode: 'class', // Ensures the 'dark' class on <html> activates dark mode
            theme: {
                extend: {
                    colors: {
                        // Custom dark mode colors based on request
                        'primary': '#dc2626', // Red 600 (used for accents)
                        'card-bg': '#1e1f20', // Custom dark grey for card
                        'body-bg': '#131314', // Custom darker grey for body
                        'input-bg': '#2a2b2c', // Slightly lighter grey for input for contrast
                    }
                }
            }
        }
    </script>
    
    <!-- 2. QR Code Library CDN (qrcode.js - handles auto-versioning) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <!-- 3. Inline CSS for QR Code Area (Ensures it stands out) -->
    <style>
        /* Styles to make the QR code stand out against the dark background */
        #qrcode-output {
            padding: 0.5rem; /* MODIFIED: Reduced padding from 1rem to 0.5rem for better fit */
            background-color: #ffffff; /* White background for the QR code */
            border-radius: 0.75rem; /* Slightly larger rounded corners */
            box-shadow: 0 10px 15px -3px rgba(220, 38, 38, 0.4), 0 4px 6px -4px rgba(220, 38, 38, 0.2); /* Red shadow for highlight */
            /* qrcode.js generates a Canvas or Table, we ensure it's centered */
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }

        /* Target the canvas/table generated by qrcode.js to prevent color inversion */
        #qrcode-output > canvas, #qrcode-output > table {
            background-color: white !important;
            border-radius: 0.25rem; /* Slight rounding on the code itself */
        }
        
        /* Ensure the input area does not shift when content changes */
        textarea {
            resize: none;
        }
    </style>
</head>

<body class="bg-body-bg text-gray-100 min-h-screen flex items-center justify-center p-4 antialiased">

    <!-- QR Code Generator Card -->
    <div class="w-full max-w-lg bg-card-bg p-8 rounded-2xl shadow-xl border border-primary/20">
        <h1 class="text-3xl font-extrabold mb-6 text-white border-b-4 border-primary pb-3 tracking-tight">
            Live QR Code Generator
        </h1>

        <!-- Input Field -->
        <div class="mb-8">
            <label for="dataInput" class="block text-sm font-semibold mb-2 text-gray-400">
                Enter Text or URL:
            </label>
            <textarea 
                id="dataInput" 
                rows="5" 
                class="w-full p-4 bg-input-bg border border-gray-700/50 rounded-xl text-white placeholder-gray-500 focus:ring-2 focus:ring-primary focus:border-primary transition duration-200"
                placeholder="Type here to generate your QR code..."
            >https://google.com</textarea>
        </div>

        <!-- QR Code Display Area -->
        <div class="flex flex-col items-center">
            <h2 class="text-xl font-semibold mb-6 text-gray-300">Generated Code:</h2>
            <div id="qrcode-output" class="w-full max-w-xs aspect-square">
                <!-- QR Code will be generated here -->
            </div>
            <p id="charCount" class="text-sm mt-4 text-gray-500 font-mono">Characters: 0</p>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        const inputField = document.getElementById('dataInput');
        const outputElement = document.getElementById('qrcode-output');
        const charCountElement = document.getElementById('charCount');
        let qrcodeInstance = null; // Variable to hold the QR code instance

        // Function to clear and regenerate the QR code
        function generateQRCode(text) {
            // 1. Update character count
            charCountElement.textContent = `Characters: ${text.length}`;

            // Handle the initial empty state
            if (!text.trim()) {
                outputElement.innerHTML = '<p class="text-gray-500 text-center text-sm">Start typing to generate a code.</p>';
                return;
            }

            // 2. Clear the old QR code
            outputElement.innerHTML = '';
            
            // 3. Dynamically calculate the QR code size to fill the container.
            // The container has 0.5rem (8px) padding on all sides, so we subtract 16px (8px * 2) 
            // from the clientWidth to get the inner content area.
            const paddingPx = 8;
            const innerSize = outputElement.clientWidth - (paddingPx * 2);

            // Ensure the size is not too small
            const qrSize = Math.max(100, innerSize);

            // 4. Create a new instance 
            qrcodeInstance = new QRCode(outputElement, {
                text: text,
                width: qrSize, // Use dynamic size
                height: qrSize, // Use dynamic size
                colorDark : "#000000",
                colorLight : "#ffffff", // CRUCIAL: White background ensures readability on dark UI
                correctLevel : QRCode.CorrectLevel.H // High error correction for robustness
            });
        }

        // Event listener for live updates
        inputField.addEventListener('input', (event) => {
            const currentText = event.target.value;
            generateQRCode(currentText);
        });

        // Initial generation with the default text in the textarea
        generateQRCode(inputField.value);
    </script>
</body>
</html>